def take_screenshot_and_append(doc, step_desc, folder="screenshots"):
    if not os.path.exists(folder):
        os.makedirs(folder)

    ts = time.strftime("%Y%m%d_%H%M%S")
    filename = os.path.join(folder, f"{ts}.png")
    driver.save_screenshot(filename)

    doc.add_paragraph(step_desc)
    doc.add_picture(filename, width=Inches(6))
    return doc
