<%@ page import="matrix.db.*" %>
<%@ page import="matrix.util.*" %>
<%@ page import="com.matrixone.apps.domain.util.*" %>

<html>
<body>

<h2>Standalone JSP with ENOVIA Login</h2>

<%
    String PASSPORTURL = "https://your-passport-url";
    String SERVICEURL  = "http://your-enovia-server:port/enovia";
    String USER        = "creator";
    String PASSWORD    = "password";
    String ROLE        = "User";

    Context context = null;

    try {
        System.setProperty("bypass.cert", "true");

        context = Util.connect(
                    SERVICEURL,
                    PASSPORTURL,
                    USER,
                    PASSWORD,
                    ROLE,
                    "",
                    true
                 );

        if (context == null || !context.isConnected()) {
            out.println("<p style='color:red;'>❌ ENOVIA Login Failed</p>");
        } else {
            out.println("<p style='color:green;'>✔ ENOVIA Login Successful</p>");

            String fullName = MqlUtil.mqlCommand(
                context,
                "print person $1 select fullname dump",
                USER
            );

            out.println("<p>Full Name: <b>" + fullName + "</b></p>");
        }

    } catch (Exception e) {
        out.println("<pre style='color:red;'>");
        e.printStackTrace(new java.io.PrintWriter(out));
        out.println("</pre>");
    } finally {
        try {
            if (context != null && context.isConnected()) {
                context.close();
            }
        } catch (Exception ex) {
            out.println("<pre>");
            ex.printStackTrace(new java.io.PrintWriter(out));
            out.println("</pre>");
        }
    }
%>

</body>
</html>
